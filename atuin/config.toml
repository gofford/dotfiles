# Atuin Configuration
# https://docs.atuin.sh/configuration/config/

## ─────────────────────────────────────────────────────────────
## General Settings
## ─────────────────────────────────────────────────────────────

# Date format: "us" (MM/DD) or "uk" (DD/MM)
dialect = "uk"

# Store failed commands (non-zero exit)? Useful for debugging
store_failed = true

# Auto-sync frequency (requires login: `atuin login`)
auto_sync = true
sync_frequency = "1h"

## ─────────────────────────────────────────────────────────────
## Search Behavior
## ─────────────────────────────────────────────────────────────

# Search mode: "prefix" | "fulltext" | "fuzzy" | "skim"
# fuzzy = match characters anywhere (like fzf)
search_mode = "fuzzy"

# Default filter: "global" | "host" | "session" | "directory"
# host = prioritize commands from this machine
filter_mode = "host"

# What filter to use when pressing up arrow
filter_mode_shell_up_key_binding = "directory"

# Workspace mode: filter by git repo when in a repo
workspaces = true

## ─────────────────────────────────────────────────────────────
## UI Settings
## ─────────────────────────────────────────────────────────────

# Style: "auto" | "full" | "compact"
# compact = more results, less decoration
style = "compact"

# Rows to show in inline mode (Ctrl+R)
inline_height = 20

# Show command preview pane
show_preview = true

# Show help text at bottom
show_help = true

# Show tabs for filter modes
show_tabs = true

# Timestamps in search results: "true" | "false"  
timestamps = true

# Time format for timestamps
time_format = "%Y-%m-%d %H:%M"

# Exit on ESC
exit_mode = "return-original"

## ─────────────────────────────────────────────────────────────
## Keybindings (in atuin native UI)
## ─────────────────────────────────────────────────────────────

# Keymap style: "auto" | "emacs" | "vim-normal" | "vim-insert"
keymap_mode = "auto"

# Cursor style in vim mode
keymap_cursor = { emacs = "blink-block", vim_insert = "blink-bar", vim_normal = "steady-block" }

# Return query if no results (allows running new commands)
return_default_text = true

# Enter behavior: execute immediately or return to shell for editing
enter_accept = true

## ─────────────────────────────────────────────────────────────
## History Filters (privacy/noise reduction)
## ─────────────────────────────────────────────────────────────

# Auto-filter secrets (AWS keys, GitHub PATs, Slack tokens, etc.)
secrets_filter = true

# Filter out noisy/trivial commands from history
history_filter = [
    "^\\s+",           # Commands starting with space (intentionally hidden)
    "^clear$",
    "^pwd$",
    "^exit$",
    "^ls$",
    "^ll$",
    "^la$",
    "^cd$",
    "^cd -$",
    "^z$",             # zoxide without args
    "^\\.$",           # Just a dot
    "^\\.\\.$",        # Just ..
]

# Directories to never record history from
# cwd_filter = [
#     "^/private",     # macOS temp dirs
# ]

## ─────────────────────────────────────────────────────────────
## Statistics
## ─────────────────────────────────────────────────────────────

[stats]
# Track subcommands separately (git commit vs git push)
common_subcommands = [
    "brew",
    "cargo",
    "docker",
    "git",
    "go",
    "gs",              # git-spice
    "just",
    "kubectl",
    "minikube",
    "npm",
    "terraform",
    "uv",
]

# Strip these prefixes for cleaner stats
common_prefix = ["sudo", "time", "caffeinate"]

# Ignore these entirely in stats
ignored_commands = ["ls", "ll", "la", "cd", "z", "pwd", "clear", "exit"]

## ─────────────────────────────────────────────────────────────
## Sync (optional - requires `atuin register` or `atuin login`)
## ─────────────────────────────────────────────────────────────

[sync]
# Enable sync v2 protocol
records = true
